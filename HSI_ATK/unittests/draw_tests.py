import unittest as ut
import numpy as np

import skimage.draw as draw
import HSI_ATK.Generators as gen

class TestDrawMethods(ut.TestCase):

    def test_ellipse(self):
        rr, cc = draw.ellipse(2, 2, 2, 2, shape=(5, 5))
        data = np.zeros((5, 5))
        data[rr, cc] = 1
        test_array = np.array([
            [0, 0, 0, 0, 0],
            [0, 1, 1, 1, 0],
            [0, 1, 1, 1, 0],
            [0, 1, 1, 1, 0],
            [0, 0, 0, 0, 0]
        ])
        err = "arrays do not match! ellipse slicing error!"
        np.testing.assert_array_equal(data, test_array, err_msg=err)


    def test_ellipsoid(self):
        ell = draw.ellipsoid(2, 2, 2, levelset=True)
        rr, cc = draw.ellipse(3, 3, 2, 2, shape=(7, 7))
        data = np.zeros((7, 7, 7))
        data[:, rr, cc] = ell[:, rr, cc]
        test_array = np.array([
            [
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., 1.75, 1.5, 1.75, 0., 0.],
                [0., 0., 1.5, 1.25, 1.5, 0., 0.],
                [0., 0., 1.75, 1.5, 1.75, 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
            ],
            [
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., 0.5, 0.25, 0.5, 0., 0.],
                [0., 0., 0.25, 0., 0.25, 0., 0.],
                [0., 0., 0.5, 0.25, 0.5, 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
            ],
            [
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., -0.25, -0.5, -0.25, 0., 0.],
                [0., 0., -0.5, -0.25, -0.5, 0., 0.],
                [0., 0., -0.25, -0.5, -0.25, 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
            ],
            [
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., -0.5, -0.75, -0.5, 0., 0.],
                [0., 0., -0.75, -1, -0.75, 0., 0.],
                [0., 0., -0.5, -0.75, -0.5, 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
            ],
            [
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., -0.25, -0.5, -0.25, 0., 0.],
                [0., 0., -0.5, -0.75, -0.5, 0., 0.],
                [0., 0., -0.25, -0.5, -0.25, 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
            ],
            [
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., 0.5, 0.25, 0.5, 0., 0.],
                [0., 0., 0.25, 0, 0.25, 0., 0.],
                [0., 0., 0.5, 0.25, 0.5, 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
            ],
            [
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., 1.75, 1.5, 1.75, 0., 0.],
                [0., 0., 1.5, 1.25, 1.5, 0., 0.],
                [0., 0., 1.75, 1.5, 1.75, 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
                [0., 0., 0., 0., 0., 0., 0.],
            ],
        ])
        data.astype('float')
        test_array.astype('float')
        print(test_array, '\n', test_array.shape)
        print('\n', data, '\n', data.shape)
        err = "arrays do not match! 3d image gen error!"
        np.testing.assert_array_equal(data, test_array, err_msg=err)


if __name__ == '__main__':
    ut.main()
